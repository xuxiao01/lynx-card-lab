#!/bin/bash

echo "ðŸ”§ Lynx çŽ¯å¢ƒé…ç½®å·¥å…·"
echo "=========================="
echo ""

# èŽ·å–æœ¬æœº IP
IP=$(ifconfig | grep "inet " | grep -v 127.0.0.1 | awk '{print $2}' | head -1)

if [ -z "$IP" ]; then
    echo "âŒ æ— æ³•è‡ªåŠ¨èŽ·å– IP åœ°å€"
    echo "è¯·æ‰‹åŠ¨è¾“å…¥ä½ çš„ IP åœ°å€ï¼š"
    read IP
fi

echo "âœ… æ£€æµ‹åˆ° IP åœ°å€: $IP"
echo ""

# ç”Ÿæˆ .env.localï¼ˆå¼€å‘çŽ¯å¢ƒï¼‰
cat > .env.local << EOF
# Lynx å¼€å‘çŽ¯å¢ƒé…ç½®
# è‡ªåŠ¨ç”ŸæˆäºŽ $(date)

# ============================================
# åŽç«¯ API åœ°å€ï¼ˆå®Œæ•´ URLï¼‰
# ============================================
VITE_API_HOST=http://$IP:4000

# ============================================
# å‰ç«¯æœåŠ¡å™¨åœ°å€ï¼ˆå®Œæ•´ URLï¼‰
# ============================================
VITE_FRONTEND_URL=http://$IP:3000

# ============================================
# æ³¨æ„äº‹é¡¹ï¼š
# ============================================
# 1. ä¿®æ”¹åŽéœ€è¦é‡å¯å¼€å‘æœåŠ¡å™¨ï¼ˆCtrl+C ç„¶åŽ npm run devï¼‰
# 2. æ­¤æ–‡ä»¶ä¸ä¼šè¢«æäº¤åˆ° Gitï¼ˆä¸ªäººé…ç½®ï¼‰
# 3. å¦‚æžœ IP å˜åŒ–ï¼Œé‡æ–°è¿è¡Œ ./setup-env.sh
EOF

echo "âœ… å·²ç”Ÿæˆ .env.local æ–‡ä»¶"
echo ""
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "ðŸ“‹ é…ç½®å†…å®¹ï¼š"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
cat .env.local | grep -E "^VITE_"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""
echo "ðŸ“ ä¸‹ä¸€æ­¥æ“ä½œï¼š"
echo ""
echo "1ï¸âƒ£  å¯åŠ¨åŽç«¯ APIï¼š"
echo "   node mock/server.cjs"
echo ""
echo "2ï¸âƒ£  å¯åŠ¨å‰ç«¯å¼€å‘æœåŠ¡å™¨ï¼š"
echo "   npm run dev"
echo ""
echo "3ï¸âƒ£  åœ¨æµè§ˆå™¨ä¸­æµ‹è¯•ï¼š"
echo "   http://$IP:3000"
echo ""
echo "4ï¸âƒ£  åœ¨ Lynx Explorer ä¸­åŠ è½½ï¼š"
echo "   http://$IP:3000/main.lynx.bundle"
echo ""
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "ðŸ’¡ æç¤ºï¼š"
echo "   - å¦‚æžœ IP åœ°å€å˜åŒ–ï¼Œé‡æ–°è¿è¡Œæ­¤è„šæœ¬"
echo "   - ä¿®æ”¹ .env.local åŽéœ€è¦é‡å¯å¼€å‘æœåŠ¡å™¨"
echo "   - è¯¦ç»†è¯´æ˜Žè¯·æŸ¥çœ‹ï¼šçŽ¯å¢ƒå˜é‡é…ç½®è¯´æ˜Ž.md"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"

