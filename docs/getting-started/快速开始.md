# 🚀 Lynx 项目快速开始

## 1️⃣ 配置环境变量（首次必做）

### 方法 1：自动配置（推荐）

```bash
# 自动检测 IP 并生成 .env.local
./setup-env.sh
```

### 方法 2：手动配置

```bash
# 1. 获取本机 IP
ifconfig | grep "inet " | grep -v 127.0.0.1

# 2. 编辑 .env.local（已创建）
# 替换 192.168.0.100 为你的 IP
vim .env.local
```

配置内容：
```bash
VITE_API_HOST=http://你的IP:4000
VITE_FRONTEND_URL=http://你的IP:3000
```

## 2️⃣ 启动服务

### 终端 1：启动后端

```bash
node mock/server.cjs
```

应该看到：
```
✅ Mock API 运行在 http://localhost:4000
📡 局域网访问: http://192.168.0.100:4000
```

### 终端 2：启动前端

```bash
npm run dev
```

应该看到：
```
➜  Local:   http://localhost:3000/
➜  Network: http://192.168.0.100:3000/
```

## 3️⃣ 测试

### 浏览器测试

打开：`http://你的IP:3000`

应该能看到餐厅页面，包括：
- ✅ 餐厅信息
- ✅ 餐厅封面图片
- ✅ 团购商品列表

### Lynx Explorer 测试

1. 打开 Lynx Explorer App
2. 输入 URL：`http://你的IP:3000/main.lynx.bundle`
3. 点击加载

应该看到：
- ✅ 餐厅数据加载成功
- ✅ 图片正常显示
- ✅ 团购列表正常显示

## 4️⃣ 验证配置

在控制台应该看到：

```
[HTTP] Lynx 环境检测:
  - API Host: http://192.168.0.100:4000  ← 你的 IP
  - 环境: 开发

[URL] 前端服务器地址: http://192.168.0.100:3000  ← 你的 IP

✅ 获取餐厅数据成功！
✅ 获取团购数据成功！
```

## 5️⃣ 构建生产版本

```bash
# 构建
pnpm build

# 检查产物
ls -lh dist/main.lynx.bundle

# 应该看到约 100KB+ 的 bundle 文件
```

## ⚠️ 常见问题

### 问题 1：API 请求失败

**错误**：`HTTP 499: unsupported URL` 或 `Could not connect to the server`

**解决**：
1. 检查 `.env.local` 中的 IP 是否正确
2. 确保使用的是真实 IP，不是 `localhost`
3. 确保端口号正确（后端 4000，前端 3000）
4. 重启开发服务器

### 问题 2：图片不显示

**错误**：图片路径 404

**解决**：
1. 检查 `VITE_FRONTEND_URL` 配置是否正确
2. 确保前端服务器正在运行
3. 查看控制台的 `[URL]` 日志

### 问题 3：修改 .env.local 不生效

**解决**：
```bash
# 停止服务器（Ctrl+C）
# 重新启动
npm run dev
```

### 问题 4：IP 地址变化了

**解决**：
```bash
# 重新运行配置脚本
./setup-env.sh

# 然后重启服务器
```

## 📋 端口说明

| 服务 | 端口 | 说明 |
|------|------|------|
| Mock 后端 | 4000 | API 服务 |
| 前端开发服务器 | 3000 | 静态资源和 bundle |

## 📚 详细文档

- **`环境变量配置说明.md`** - 环境变量详细说明
- **`Lynx真机调试说明.md`** - 真机调试完整流程
- **`Lynx网络请求问题总结.md`** - 网络问题排查
- **`API使用说明.md`** - API 使用方法
- **`性能监控说明.md`** - 性能监控集成
- **`Lynx-Performance-API-FAQ.md`** - Performance API 常见问题

## 🎯 快速命令参考

```bash
# 配置环境
./setup-env.sh

# 启动后端
node mock/server.cjs

# 启动前端
npm run dev

# 构建
pnpm build

# 获取 IP
ifconfig | grep "inet " | grep -v 127.0.0.1

# 测试后端
curl http://你的IP:4000/api/shops

# 查看 .env.local
cat .env.local
```

## ✅ 检查清单

在开始开发前，确保：

- [ ] `.env.local` 文件已创建并配置正确
- [ ] IP 地址是真实 IP，不是 `localhost`
- [ ] 后端服务正在运行（端口 4000）
- [ ] 前端服务正在运行（端口 3000）
- [ ] 浏览器测试通过
- [ ] Lynx Explorer 测试通过

全部完成？**开始愉快地开发吧！** 🎉

